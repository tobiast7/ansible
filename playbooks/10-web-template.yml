---
    - name: Configure HTTPS for nginx
      hosts: web
      become: true
      tasks:

        - name: Copy HTTPS configuration to nginx
          ansible.builtin.copy:
            src: files/https.conf
            dest: /etc/nginx/conf.d/https.conf
            owner: root
            group: root
            mode: '0644'
          register: resultconf

        - name: Deploy example.internal.conf.j2 nginx config
          ansible.builtin.template:
            src: templates/example.internal.conf.j2
            dest: /etc/nginx/conf.d/example.internal.conf
            owner: root
            group: root
            mode: '0644'
          register: resulttemplate
          notify:
            - restart nginx

        - name: Create directory structure
          ansible.builtin.file:
            path: /var/www/example.internal/html    
            state: directory
            owner: root
            group: root
            mode: '0755'

        - name: Upload index.html to example.internal web root
          ansible.builtin.copy:
            src: files/index.html
            dest: /var/www/example.internal/html/index.html
            owner: root
            group: root
            mode: '0644'
          register: resultindex

      handlers:

        - name: restart nginx
          ansible.builtin.service:
            name: nginx
            state: restarted

        - name: Print the value of result
          ansible.builtin.debug:
            var: resultindex and resultconf and resulttemplate