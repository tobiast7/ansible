
---
    - hosts: db
      become: true
      tasks:
        - name: Ensure MariaDB-server is installed.
          ansible.builtin.package:
            name: mariadb-server
            state: present

        - name: Mariadb start at boot
          ansible.builtin.service:
            name: mariadb
            state: started
            enabled: true
        
        - name: Ensure PyMySQL is installed
          ansible.builtin.package:
            name: python3-PyMySQL
            state: present
        
        - name: Create database webappdb
          community.mysql.mysql_db:
            name: webappdb
            state: present
            login_unix_socket: /var/lib/mysql/mysql.sock
        
        - name: Create user webappuser
          community.mysql.mysql_user:
            name: webappuser
            password: secretpassword
            priv: webappdb.*:ALL
            state: present
            login_unix_socket: /var/lib/mysql/mysql.sock